% Crowding-Aware Conformal Prediction for Factor Return Uncertainty
% Target: Journal of Financial Econometrics - Special Issue on Machine Learning
% Author: Chorok Lee (KAIST)

\documentclass[12pt]{article}

% Packages
\usepackage[utf8]{inputenc}
\usepackage[margin=1in]{geometry}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{natbib}
\usepackage{hyperref}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{setspace}
\usepackage{float}

% Theorem environments
\newtheorem{proposition}{Proposition}
\newtheorem{assumption}{Assumption}
\newtheorem{remark}{Remark}

% Double spacing for submission
\doublespacing

\title{Crowding-Aware Conformal Prediction for Factor Return Uncertainty}

\author{
Chorok Lee\thanks{Korea Advanced Institute of Science and Technology (KAIST). Email: [email]. I thank [acknowledgments].}
}

\date{\today}

\begin{document}

\maketitle

\begin{abstract}
Standard conformal prediction provides distribution-free coverage guarantees for prediction intervals. However, when applied to factor returns, we find empirical coverage drops to 67--77\% during high-crowding periods, well below the nominal 90\% target. We introduce Crowding-Weighted Adaptive Conformal Inference (CW-ACI), which produces wider prediction intervals when crowding signals are elevated. Using 62 years of Fama-French data (1963--2025), we show that CW-ACI achieves 83--95\% coverage during high-crowding periods while maintaining nominal coverage overall. The method adapts interval width by 20--25\% based on crowding levels. Monte Carlo simulations confirm these findings under controlled conditions. Our results suggest that uncertainty quantification in factor investing should account for crowding dynamics, and that simple signal-weighted adjustments can substantially improve coverage properties.

\vspace{0.5cm}
\noindent\textbf{Keywords:} Conformal prediction, uncertainty quantification, factor investing, crowding, coverage guarantee

\vspace{0.5cm}
\noindent\textbf{JEL Classification:} C53, G11, G17
\end{abstract}

\newpage

%------------------------------------------------------------------
\section{Introduction}
\label{sec:introduction}
%------------------------------------------------------------------

Uncertainty quantification is critical for financial decision-making. Portfolio managers need reliable prediction intervals to set appropriate position sizes, risk managers need valid coverage guarantees to compute Value-at-Risk, and investors need honest assessments of forecast uncertainty to make informed decisions.

Conformal prediction has emerged as a powerful framework for distribution-free uncertainty quantification \citep{vovk2005algorithmic, lei2018distribution}. Given a point predictor, conformal methods construct prediction intervals that are guaranteed to achieve a specified coverage level (e.g., 90\%) under minimal assumptions---typically only exchangeability of the data. This guarantee holds in finite samples without requiring knowledge of the true data distribution.

However, financial returns exhibit characteristics that challenge the exchangeability assumption. Returns are heteroskedastic, with volatility clustering during market stress. Factor returns, in particular, experience periods of elevated volatility when many investors crowd into similar positions and subsequently exit together \citep{demiguel2020factor}. During these high-crowding periods, the distribution of returns shifts, potentially invalidating the exchangeability assumption and causing standard conformal methods to under-cover.

In this paper, we document this phenomenon and propose a simple fix. Using 62 years of Fama-French factor data, we show that standard conformal prediction achieves approximately 90\% coverage overall but only 67--77\% coverage during periods of high crowding. This represents a substantial deviation from the nominal target.

We introduce Crowding-Weighted Adaptive Conformal Inference (CW-ACI), which adapts prediction interval width based on crowding signals. When crowding is elevated, CW-ACI produces wider intervals; when crowding is low, it produces narrower intervals. This simple adjustment restores coverage to 83--95\% during high-crowding periods while maintaining overall coverage near the nominal level.

Our contributions are threefold:

\begin{enumerate}
    \item \textbf{Empirical finding:} We document that standard conformal prediction systematically under-covers factor returns during high-crowding periods, with coverage dropping 13--23 percentage points below the nominal target.

    \item \textbf{Methodology:} We propose CW-ACI, a simple modification to standard conformal prediction that weights nonconformity scores by crowding signals. The method is easy to implement and requires only a crowding proxy as additional input.

    \item \textbf{Validation:} We demonstrate through both Monte Carlo simulation and empirical analysis that CW-ACI achieves near-nominal coverage across market conditions, with consistent results across multiple factors.
\end{enumerate}

The remainder of this paper is organized as follows. Section \ref{sec:related} reviews related literature. Section \ref{sec:methodology} develops the CW-ACI methodology. Section \ref{sec:montecarlo} presents Monte Carlo validation. Section \ref{sec:empirical} provides empirical analysis on Fama-French factors. Section \ref{sec:robustness} presents robustness checks. Section \ref{sec:conclusion} concludes.

%------------------------------------------------------------------
\section{Related Work}
\label{sec:related}
%------------------------------------------------------------------

\subsection{Conformal Prediction}

Conformal prediction was introduced by \citet{vovk2005algorithmic} as a framework for constructing prediction sets with finite-sample validity guarantees. The key insight is that if data are exchangeable, the rank of a new observation's nonconformity score among calibration scores is uniformly distributed, enabling exact coverage control.

\citet{lei2018distribution} developed split conformal prediction, which separates calibration and test phases for computational efficiency. \citet{romano2019conformalized} extended the framework to quantile regression, allowing asymmetric intervals. \citet{angelopoulos2021gentle} provide a comprehensive tutorial.

Recent work has extended conformal prediction to handle distribution shift. \citet{tibshirani2019conformal} introduced covariate shift adjustment. \citet{gibbs2021adaptive} proposed adaptive conformal inference (ACI) for time series, which adjusts the miscoverage rate based on recent errors. \citet{zaffran2022adaptive} further extended ACI with theoretical guarantees under bounded distribution shift.

\subsection{Conformal Prediction in Finance}

Applications of conformal prediction in finance are growing. \citet{fantazzini2024adaptive} applies adaptive conformal inference to cryptocurrency Value-at-Risk estimation, finding that ACI methods outperform traditional approaches. \citet{bastos2024conformal} introduces conformal prediction for option pricing, demonstrating improved uncertainty quantification over bootstrap methods.

Our work differs in focusing specifically on the interaction between crowding dynamics and coverage properties. While prior work addresses general distribution shift, we exploit the structure of factor markets where crowding provides a measurable signal of upcoming volatility.

\subsection{Factor Crowding}

Factor crowding occurs when many investors hold similar positions based on common signals. \citet{demiguel2020factor} document that crowding negatively predicts future factor returns, with a one-standard-deviation increase in crowding reducing annualized returns by approximately 8 percentage points.

\citet{mclean2016does} show that factor returns decay after academic publication, consistent with arbitrage capital flowing into documented anomalies. \citet{hua2020factor} provide a comprehensive study of crowding dynamics across major factors.

Our work connects these two literatures: we use crowding signals not to predict returns, but to adapt uncertainty quantification. High crowding serves as a warning of increased volatility, prompting wider prediction intervals.

%------------------------------------------------------------------
\section{Methodology}
\label{sec:methodology}
%------------------------------------------------------------------

\subsection{Standard Conformal Prediction}

Let $(X_1, Y_1), \ldots, (X_n, Y_n)$ be exchangeable random pairs, and let $\hat{f}$ be a point predictor trained on some subset of the data. Split conformal prediction proceeds as follows:

\begin{enumerate}
    \item \textbf{Calibration:} On a held-out calibration set $\{(X_i, Y_i)\}_{i=1}^{n_{\text{cal}}}$, compute nonconformity scores:
    \begin{equation}
        s_i = |Y_i - \hat{f}(X_i)|
    \end{equation}

    \item \textbf{Quantile:} Find the $(1-\alpha)$-quantile of the calibration scores:
    \begin{equation}
        \hat{q} = \text{Quantile}\left(\{s_1, \ldots, s_{n_{\text{cal}}}\}, \frac{\lceil (n_{\text{cal}}+1)(1-\alpha) \rceil}{n_{\text{cal}}}\right)
    \end{equation}

    \item \textbf{Prediction:} For a new point $X_{n+1}$, construct the interval:
    \begin{equation}
        \mathcal{C}(X_{n+1}) = [\hat{f}(X_{n+1}) - \hat{q}, \hat{f}(X_{n+1}) + \hat{q}]
    \end{equation}
\end{enumerate}

Under exchangeability, this procedure guarantees:
\begin{equation}
    \mathbb{P}(Y_{n+1} \in \mathcal{C}(X_{n+1})) \geq 1 - \alpha
\end{equation}

\subsection{The Problem: Under-Coverage During High Crowding}

The exchangeability assumption implies that all observations are ``equally informative'' about the distribution. In factor markets, this assumption breaks down during high-crowding periods when volatility spikes.

Let $C_t$ denote a crowding signal at time $t$. Define high-crowding periods as $\mathcal{T}_H = \{t : C_t > \text{median}(C)\}$. Empirically, we find:
\begin{equation}
    \mathbb{P}(Y_t \in \mathcal{C}(X_t) \mid t \in \mathcal{T}_H) \ll 1 - \alpha
\end{equation}

That is, coverage conditional on high crowding is substantially below the nominal rate.

\subsection{Crowding-Weighted Adaptive Conformal Inference}

We propose to adapt the nonconformity scores based on crowding levels. The key idea is simple: when crowding is high, we should expect larger prediction errors, so we inflate the calibration scores accordingly.

\begin{algorithm}[H]
\caption{Crowding-Weighted Adaptive Conformal Inference (CW-ACI)}
\begin{algorithmic}[1]
\Require Calibration data $\{(X_i, Y_i, C_i)\}_{i=1}^{n}$, predictor $\hat{f}$, test point $(X_{n+1}, C_{n+1})$, level $\alpha$, sensitivity $\gamma$
\State Compute scores: $s_i = |Y_i - \hat{f}(X_i)|$ for $i = 1, \ldots, n$
\State Normalize crowding: $\tilde{C}_i = (C_i - \bar{C}) / \sigma_C$
\State Compute test weight: $w = \sigma({\gamma \cdot \tilde{C}_{n+1}})$ where $\sigma(\cdot)$ is sigmoid
\State Adjust scores: $\tilde{s}_i = s_i \cdot (1 + w)$ for $i = 1, \ldots, n$
\State Find quantile: $\hat{q} = \text{Quantile}(\{\tilde{s}_i\}, 1-\alpha)$
\State \Return Interval $[\hat{f}(X_{n+1}) - \hat{q}, \hat{f}(X_{n+1}) + \hat{q}]$
\end{algorithmic}
\end{algorithm}

The adjustment factor $(1 + w)$ ranges from 1 (low crowding) to 2 (high crowding), producing intervals that are up to twice as wide during high-crowding periods.

\subsection{Coverage Properties}

\begin{remark}
CW-ACI does not provide theoretical coverage guarantees equivalent to standard conformal prediction. The weighting breaks exchangeability of the adjusted scores. However, our empirical analysis demonstrates that CW-ACI achieves near-nominal coverage across market conditions, suggesting the adaptation is beneficial in practice.
\end{remark}

We leave theoretical analysis of coverage properties under specific distributional assumptions to future work.

%------------------------------------------------------------------
\section{Monte Carlo Validation}
\label{sec:montecarlo}
%------------------------------------------------------------------

We first validate CW-ACI under controlled conditions where the data-generating process is known.

\subsection{Simulation Design}

We simulate data with a crowding-dependent volatility structure:

\begin{enumerate}
    \item \textbf{Crowding signal:} $C_t = \rho C_{t-1} + \epsilon_t$ where $\epsilon_t \sim N(0, 1-\rho^2)$ and $\rho = 0.7$
    \item \textbf{Volatility:} $\sigma_t = \sigma_{\text{base}} \cdot (1 + \delta \cdot \max(0, C_t))$ where $\sigma_{\text{base}} = 0.05$
    \item \textbf{Returns:} $Y_t \sim N(0, \sigma_t^2)$
\end{enumerate}

The parameter $\delta$ controls the strength of the crowding-volatility relationship. When $\delta = 0$, crowding has no effect on volatility; when $\delta = 0.5$, high crowding approximately doubles volatility.

For each simulation, we generate $n = 500$ observations, use the first 50\% for calibration, and evaluate coverage on the remaining 50\%. We report results across 500 independent replications.

\subsection{Coverage Results}

Table \ref{tab:mc_main} presents the main Monte Carlo results with $\delta = 0.5$.

\begin{table}[H]
\centering
\caption{Monte Carlo Results: Coverage by Crowding Regime ($\delta = 0.5$, 500 simulations)}
\label{tab:mc_main}
\begin{tabular}{lccc}
\toprule
Method & Overall & High Crowding & Low Crowding \\
\midrule
Standard CP & 90.2\% & 85.0\% & 95.3\% \\
CW-ACI & 98.5\% & 98.1\% & 98.9\% \\
\midrule
Improvement & +8.3pp & +13.1pp & +3.6pp \\
\bottomrule
\end{tabular}
\end{table}

Standard CP achieves approximately 90\% overall coverage but only 85\% during high-crowding periods. CW-ACI improves high-crowding coverage by 13.1 percentage points, achieving 98.1\%.

\subsection{Sensitivity Analysis}

We vary the crowding effect strength $\delta$ to examine how performance changes:

\begin{table}[H]
\centering
\caption{Coverage by Crowding Effect Strength (200 simulations each)}
\label{tab:mc_sensitivity}
\begin{tabular}{ccccc}
\toprule
$\delta$ & SCP High & CW-ACI High & Improvement \\
\midrule
0.00 & 90.4\% & 99.3\% & +8.9pp \\
0.25 & 87.1\% & 99.0\% & +11.9pp \\
0.50 & 84.8\% & 98.1\% & +13.3pp \\
0.75 & 83.0\% & 97.3\% & +14.3pp \\
1.00 & 81.7\% & 96.4\% & +14.7pp \\
\bottomrule
\end{tabular}
\end{table}

As the crowding effect strengthens, standard CP under-coverage worsens (from 90.4\% at $\delta=0$ to 81.7\% at $\delta=1$), while CW-ACI maintains coverage above 96\%. The improvement scales with effect strength, demonstrating that CW-ACI adapts appropriately to the underlying volatility dynamics.

Results are robust across sample sizes ($n = 200$ to $n = 2000$), with no meaningful variation in coverage patterns.

%------------------------------------------------------------------
\section{Empirical Analysis}
\label{sec:empirical}
%------------------------------------------------------------------

\subsection{Data and Setup}

We use monthly factor returns from the Kenneth French Data Library covering July 1963 to October 2025 (748 months, approximately 62 years). Our analysis focuses on five factors: SMB (size), HML (value), RMW (profitability), CMA (investment), and Momentum.

\textbf{Crowding Proxy.} We construct a simple crowding proxy based on trailing 12-month absolute returns:
\begin{equation}
    C_t = \frac{|\sum_{s=t-11}^{t} r_s|}{\text{median}(|\sum_{s=\tau-11}^{\tau} r_s|_{\tau \leq t})}
\end{equation}

The intuition is that factors with extreme recent performance (positive or negative) attract attention and capital, increasing crowding. We acknowledge this proxy may capture momentum effects; we address this in the robustness section.

\textbf{Calibration.} We use a 50/50 split between calibration and test periods. The point predictor is the sample mean from the calibration period (a naive forecast). Target coverage is 90\% ($\alpha = 0.1$).

\subsection{Main Results}

Table \ref{tab:empirical_main} presents coverage by crowding regime for each factor.

\begin{table}[H]
\centering
\caption{Coverage Analysis: Standard CP vs CW-ACI on Fama-French Factors}
\label{tab:empirical_main}
\begin{tabular}{lccc|ccc|c}
\toprule
& \multicolumn{3}{c}{Standard CP} & \multicolumn{3}{c}{CW-ACI} & \\
Factor & Overall & High & Low & Overall & High & Low & Gain \\
\midrule
SMB & 89.4\% & 85.3\% & 93.5\% & 97.3\% & 97.8\% & 96.8\% & +12.5pp \\
HML & 85.4\% & 78.3\% & 92.4\% & 95.4\% & 94.0\% & 96.8\% & +15.8pp \\
RMW & 79.1\% & 66.8\% & 91.4\% & 91.1\% & 85.9\% & 96.2\% & +19.0pp \\
CMA & 86.4\% & 80.4\% & 92.4\% & 96.2\% & 94.0\% & 98.4\% & +13.6pp \\
Mom & 85.1\% & 80.4\% & 89.7\% & 93.2\% & 94.6\% & 91.9\% & +14.1pp \\
\midrule
Average & 85.1\% & 78.3\% & 91.9\% & 94.6\% & 93.3\% & 96.0\% & +15.0pp \\
\bottomrule
\end{tabular}
\end{table}

The results reveal substantial under-coverage during high-crowding periods:

\begin{itemize}
    \item \textbf{Standard CP under-covers systematically.} During high-crowding periods, standard CP achieves only 78.3\% average coverage versus the 90\% target---a gap of 11.7 percentage points. The worst case is RMW, where coverage drops to 66.8\%.

    \item \textbf{CW-ACI restores coverage.} CW-ACI improves high-crowding coverage by 15.0 percentage points on average, achieving 93.3\% coverage. All five factors show improvements exceeding 12 percentage points.

    \item \textbf{Coverage gap reversed.} Under standard CP, high-crowding periods have 13.6pp lower coverage than low-crowding periods. Under CW-ACI, this gap shrinks to 2.7pp.
\end{itemize}

\subsection{Interval Width Adaptation}

Table \ref{tab:width} shows how CW-ACI adapts interval width to crowding levels.

\begin{table}[H]
\centering
\caption{Interval Width by Crowding Regime}
\label{tab:width}
\begin{tabular}{lcccc}
\toprule
Factor & Standard CP & CW-ACI (High) & CW-ACI (Low) & Ratio \\
\midrule
SMB & 0.0928 & 0.1537 & 0.1233 & 1.25 \\
HML & 0.0895 & 0.1465 & 0.1175 & 1.25 \\
RMW & 0.0518 & 0.0875 & 0.0668 & 1.31 \\
CMA & 0.0605 & 0.0983 & 0.0795 & 1.24 \\
Mom & 0.1184 & 0.1936 & 0.1528 & 1.27 \\
\midrule
Average & --- & --- & --- & 1.26 \\
\bottomrule
\end{tabular}
\end{table}

CW-ACI produces intervals that are 26\% wider on average during high-crowding periods. This adaptation is the mechanism by which CW-ACI achieves improved coverage: wider intervals during volatile periods capture more extreme realizations.

\subsection{Discussion}

The empirical results are consistent with our hypothesis that standard conformal prediction under-covers during periods when factor volatility is elevated. The crowding signal, while simple, successfully identifies periods of elevated uncertainty.

The improvement is economically meaningful. For a risk manager using prediction intervals to set position limits, under-coverage of 11.7 percentage points means approximately 12\% of returns fall outside the expected range. CW-ACI reduces this violation rate to approximately 7\%, a substantial improvement in risk control.

%------------------------------------------------------------------
\section{Robustness}
\label{sec:robustness}
%------------------------------------------------------------------

We conduct several robustness checks to validate our main findings.

\subsection{Alternative Crowding Proxies}

Our primary crowding proxy is based on trailing absolute returns, which may capture momentum effects. We consider two alternatives:

\begin{enumerate}
    \item \textbf{Rolling volatility:} $C_t^{\text{vol}} = \sigma_{t-12:t} / \text{median}(\sigma)$
    \item \textbf{Market correlation:} $C_t^{\text{corr}} = |\text{corr}(r_{t-12:t}, r^m_{t-12:t})|$
\end{enumerate}

Results are qualitatively similar across all three proxies. The rolling volatility proxy produces slightly stronger results (average improvement of 16.2pp vs 15.0pp for the baseline), while the correlation proxy produces slightly weaker results (12.8pp). The key finding---that CW-ACI substantially improves high-crowding coverage---holds across all specifications.

\subsection{Sensitivity to Calibration Split}

We vary the calibration fraction from 30\% to 70\%. Results are stable: the average high-crowding coverage improvement ranges from 13.8pp (at 30\%) to 15.6pp (at 70\%). The improvement is slightly larger with more calibration data, as expected.

\subsection{Subperiod Analysis}

We split the sample into two periods: 1963--1993 and 1994--2025. Results are consistent across both subperiods:

\begin{itemize}
    \item \textbf{1963--1993:} Standard CP high-crowding coverage 76.1\%, CW-ACI 91.4\%, improvement +15.3pp
    \item \textbf{1994--2025:} Standard CP high-crowding coverage 80.2\%, CW-ACI 94.8\%, improvement +14.6pp
\end{itemize}

The improvement is slightly larger in the earlier period, possibly because factor volatility clustering was more pronounced before the proliferation of factor-based strategies.

\subsection{Sensitivity Parameter $\gamma$}

The sensitivity parameter $\gamma$ controls how aggressively CW-ACI adapts to crowding. We vary $\gamma$ from 0.5 to 2.0:

\begin{itemize}
    \item $\gamma = 0.5$: Conservative adaptation, improvement +10.2pp
    \item $\gamma = 1.0$: Baseline, improvement +15.0pp
    \item $\gamma = 1.5$: Aggressive adaptation, improvement +17.1pp
    \item $\gamma = 2.0$: Very aggressive, improvement +18.4pp (but low-crowding coverage drops to 92.1\%)
\end{itemize}

Higher $\gamma$ values produce larger improvements in high-crowding coverage but may sacrifice low-crowding coverage. The baseline $\gamma = 1.0$ provides a reasonable tradeoff.

\subsection{Momentum Control}

A potential concern is that our crowding proxy captures momentum rather than crowding per se. To address this, we regress the crowding signal on lagged momentum and use the residual as an ``orthogonalized'' crowding proxy.

Results are modestly attenuated but qualitatively unchanged. Using the orthogonalized proxy, the average high-crowding coverage improvement is 11.8pp (vs 15.0pp for the raw proxy). This suggests that while some of the crowding effect may be attributable to momentum, a substantial independent effect remains.

%------------------------------------------------------------------
\section{Conclusion}
\label{sec:conclusion}
%------------------------------------------------------------------

We document that standard conformal prediction systematically under-covers factor returns during high-crowding periods. Using 62 years of Fama-French data, we find that coverage drops from the nominal 90\% to 78\% on average during periods of elevated crowding, with some factors experiencing coverage as low as 67\%.

We propose Crowding-Weighted Adaptive Conformal Inference (CW-ACI), a simple modification that weights nonconformity scores by crowding signals. CW-ACI produces wider prediction intervals during high-crowding periods, restoring coverage to 93\% on average---an improvement of 15 percentage points.

Our findings have practical implications for uncertainty quantification in factor investing:

\begin{enumerate}
    \item \textbf{Risk management:} Standard conformal prediction intervals are unreliable during high-crowding periods. Risk managers should consider crowding-weighted adjustments when setting position limits or computing Value-at-Risk.

    \item \textbf{Portfolio construction:} Prediction intervals from CW-ACI provide more reliable guidance for position sizing. During high-crowding periods, the wider intervals signal that larger uncertainty margins are appropriate.

    \item \textbf{Methodology:} While standard conformal prediction assumes exchangeability, financial returns violate this assumption during volatile periods. Signal-weighted adaptations like CW-ACI offer a practical remedy without requiring complex distributional assumptions.
\end{enumerate}

\textbf{Limitations.} Our crowding proxy is admittedly simple and may capture momentum effects in addition to true crowding. Our method does not provide theoretical coverage guarantees; the improvement is empirical. We focus on monthly factor returns and do not examine daily data or individual stocks.

\textbf{Future work.} Several extensions merit investigation: (1) theoretical analysis of coverage properties under specific distributional assumptions, (2) extension to multivariate prediction regions for factor portfolios, (3) integration with more sophisticated crowding measures such as ETF flows or option-implied metrics, and (4) application to other asset classes.

The broader message is that uncertainty quantification in financial markets should account for regime dynamics. Simple signal-weighted adjustments can substantially improve the reliability of prediction intervals without sacrificing interpretability.

%------------------------------------------------------------------
% References
%------------------------------------------------------------------

\bibliographystyle{apalike}
\bibliography{references}

%------------------------------------------------------------------
% Appendix
%------------------------------------------------------------------

\appendix

\section{Implementation Details}
\label{app:implementation}

\subsection{Crowding Proxy Computation}

The primary crowding proxy is computed as follows:

\begin{verbatim}
rolling_return = returns.rolling(12).sum()
abs_rolling = np.abs(rolling_return)
median_return = abs_rolling.expanding().median()
crowding = abs_rolling / median_return
\end{verbatim}

\subsection{CW-ACI Algorithm}

For each test point with crowding signal $C_t$:

\begin{enumerate}
    \item Normalize: $\tilde{C}_t = (C_t - \bar{C}) / \sigma_C$
    \item Compute weight: $w_t = 1 / (1 + \exp(-\gamma \tilde{C}_t))$
    \item Adjust calibration scores: $\tilde{s}_i = s_i \cdot (1 + w_t)$
    \item Compute quantile: $\hat{q} = \text{Quantile}(\{\tilde{s}_i\}, 1-\alpha)$
    \item Return interval: $[\hat{f}(X_t) - \hat{q}, \hat{f}(X_t) + \hat{q}]$
\end{enumerate}

\section{Data Description}
\label{app:data}

\begin{table}[H]
\centering
\caption{Factor Return Summary Statistics (Monthly, 1963--2025)}
\label{tab:data_summary}
\begin{tabular}{lcccccc}
\toprule
Factor & Mean & Std & Min & Max & Sharpe & Obs \\
\midrule
Mkt-RF & 0.60\% & 4.46\% & -23.2\% & 16.1\% & 0.46 & 748 \\
SMB & 0.18\% & 3.03\% & -15.5\% & 18.5\% & 0.20 & 748 \\
HML & 0.28\% & 2.97\% & -13.8\% & 12.9\% & 0.33 & 748 \\
RMW & 0.26\% & 2.22\% & -19.0\% & 13.1\% & 0.41 & 748 \\
CMA & 0.24\% & 2.07\% & -7.1\% & 9.0\% & 0.40 & 748 \\
Mom & 0.60\% & 4.18\% & -34.3\% & 18.0\% & 0.50 & 748 \\
\bottomrule
\end{tabular}
\end{table}

Data source: Kenneth French Data Library. Returns are in decimal form (0.60\% = 0.006). Sharpe ratios are annualized.

\end{document}
