# 문제 4: 뉴턴 방법 (10점)

## 📚 강의 노트 참조
- **Lecture 01: Numerical Methods Introduction**
  - p.23-25: Newton-Raphson method for root finding
- **참고**: 최적화를 위한 Newton 방법은 root-finding의 확장

---

## 📋 원본 문제

> **문제 4 (10점)**
>
> 목적 함수 $f(x)$를 최소화하기 위해 Newton's Method를 적용할 때:
>
> **(1)** 단변량 함수의 업데이트 공식을 유도하시오. (5점)
>
> **(2)** 다변량 함수의 업데이트 방법을 설명하시오. (5점)

---

## 🎯 문제가 뭘 묻는 건가요?

함수의 **최솟값**을 찾는 방법을 묻고 있습니다.

예: 비용을 최소화하고 싶을 때, 어떤 $x$ 값에서 비용이 가장 낮은지 찾기

---

## 💡 Step 0: "최적화"의 기본 원리

### 최솟값은 어디에 있나요?

고등학교 미적분을 떠올려 봅시다:

**최솟값(또는 최댓값)에서는 기울기가 0입니다!**

```
f(x)
 ↑
 │    ╱╲
 │   ╱  ╲
 │  ╱    ╲
 │ ╱      ╲___╱╲
 │╱              ╲
 └──────────────────→ x
         ↑
      여기서 기울기 = 0
      (최솟값!)
```

수학적으로:
$$f'(x^*) = 0 \quad \text{(최솟값 조건)}$$

**따라서**: 최솟값을 찾으려면 $f'(x) = 0$인 점을 찾으면 됩니다!

---

## 💡 Step 1: Newton 방법의 아이디어

### 문제 재정의

> 원래 문제: $f(x)$의 최솟값 찾기
>
> 바꾼 문제: $g(x) = f'(x) = 0$인 $x$ 찾기 (방정식의 해 찾기)

### Newton 방법이란?

**방정식 $g(x) = 0$의 해를 빠르게 찾는 방법**입니다.

핵심 아이디어:
1. 현재 위치에서 함수를 **직선으로 근사**
2. 그 직선이 $x$축과 만나는 점으로 이동
3. 반복!

```
 g(x)
  ↑
  │      ╱
  │     ╱
  │    ╱ ● ← 현재 위치 (xₙ, g(xₙ))
  │   ╱ ╱
  │  ╱ ╱ ← 접선 (직선 근사)
  │ ╱ ╱
──┼───●──────────→ x
  │   ↑
  │  x_{n+1}
  │  (접선이 x축과 만나는 점)
```

---

## 💡 (1) 단변량 함수 업데이트 공식 유도

### 우리의 목표

$f'(x) = 0$인 점을 찾기 위해 Newton 방법 적용

### Step 1: 현재 위치에서 $f'(x)$를 직선으로 근사

점 $x_n$ 근처에서 $f'(x)$를 테일러 전개 (1차까지만):

$$f'(x) \approx f'(x_n) + f''(x_n) \cdot (x - x_n)$$

**직관**: 현재 위치에서의 값 + (기울기 × 이동거리)

### Step 2: 이 직선이 0이 되는 점 찾기

$$0 = f'(x_n) + f''(x_n) \cdot (x - x_n)$$

### Step 3: $x$에 대해 정리

$$f''(x_n) \cdot (x - x_n) = -f'(x_n)$$

$$x - x_n = -\frac{f'(x_n)}{f''(x_n)}$$

$$x = x_n - \frac{f'(x_n)}{f''(x_n)}$$

### ✅ 업데이트 공식

$$\boxed{x_{n+1} = x_n - \frac{f'(x_n)}{f''(x_n)}}$$

---

### 직관적 이해

각 항의 의미를 살펴봅시다:

```
x_{n+1} = x_n - f'(x_n) / f''(x_n)
          ───   ────────────────
           ↑          ↑
       현재 위치    이동량

이동량 = 기울기 / 곡률
       = "얼마나 경사진가" / "얼마나 휘어있나"
```

**비유**:

```
스키 타기 비유:

f'(x_n) = 현재 경사도 ("언덕이 얼마나 가파른가")
f''(x_n) = 지형의 곡률 ("얼마나 빨리 평평해지는가")

경사가 급하고(f' 큼) 천천히 평평해지면(f'' 작음):
  → 많이 이동해야 함

경사가 완만하고(f' 작음) 빨리 평평해지면(f'' 큼):
  → 조금만 이동하면 됨
```

---

### 예제로 이해하기

$f(x) = x^2$의 최솟값을 찾아봅시다.

$$f'(x) = 2x, \quad f''(x) = 2$$

업데이트 공식:
$$x_{n+1} = x_n - \frac{2x_n}{2} = x_n - x_n = 0$$

**한 번에 정확한 답 $x = 0$을 찾습니다!**

(이차함수에서는 Newton 방법이 한 번에 수렴)

---

## 💡 (2) 다변량 함수 업데이트 방법

### 다변량이란?

변수가 **여러 개**인 경우입니다.

$$f(x_1, x_2, \ldots, x_n) \quad \text{또는} \quad f(\mathbf{x})$$

예: 포트폴리오 최적화에서 각 자산의 비중 $(w_1, w_2, \ldots, w_n)$ 결정

---

### 새로운 용어 정리

#### Gradient (그래디언트) = 기울기 벡터

각 변수에 대한 **편미분**을 모은 벡터:

$$\nabla f(\mathbf{x}) = \begin{pmatrix} \frac{\partial f}{\partial x_1} \\ \frac{\partial f}{\partial x_2} \\ \vdots \\ \frac{\partial f}{\partial x_n} \end{pmatrix}$$

**직관**: "각 방향으로 얼마나 가파른가"를 모아놓은 것

```
등고선 지도에서:

  ↗ Gradient 방향
 ╱  (가장 가파른 오르막)
●───→ x₁
│
↓ x₂
```

#### Hessian (헤시안) = 곡률 행렬

모든 **2차 편미분**을 모은 행렬:

$$H = \nabla^2 f(\mathbf{x}) = \begin{pmatrix} \frac{\partial^2 f}{\partial x_1^2} & \frac{\partial^2 f}{\partial x_1 \partial x_2} & \cdots \\ \frac{\partial^2 f}{\partial x_2 \partial x_1} & \frac{\partial^2 f}{\partial x_2^2} & \cdots \\ \vdots & \vdots & \ddots \end{pmatrix}$$

**직관**: "각 방향으로 얼마나 휘어있나"를 모아놓은 것

---

### 단변량 → 다변량 확장

| 단변량 | 다변량 | 의미 |
|-------|-------|------|
| $f'(x)$ | $\nabla f(\mathbf{x})$ | 기울기 |
| $f''(x)$ | $H(\mathbf{x})$ | 곡률 |
| 나눗셈: $\frac{a}{b}$ | 역행렬: $H^{-1} \cdot \mathbf{v}$ | 나누기 연산 |

### 다변량 업데이트 공식

$$\boxed{\mathbf{x}_{n+1} = \mathbf{x}_n - H^{-1}(\mathbf{x}_n) \cdot \nabla f(\mathbf{x}_n)}$$

또는 같은 의미로:

$$\boxed{\mathbf{x}_{n+1} = \mathbf{x}_n - [\nabla^2 f(\mathbf{x}_n)]^{-1} \cdot \nabla f(\mathbf{x}_n)}$$

---

### 왜 역행렬이 필요한가?

단변량처럼 그냥 성분별로 나누면 안 될까요?

**안 됩니다.** 변수들이 서로 얽혀있기 때문입니다.

$$f(x_1, x_2) = x_1^2 + 3x_1 x_2 + 2x_2^2$$

위 함수에서 $x_1$을 바꾸면 $x_2$ 방향 기울기도 바뀝니다. 이 "얽힘"이 Hessian의 비대각 성분입니다.

단변량 유도를 그대로 따라가면:

$$\nabla f(\mathbf{x}) \approx \nabla f(\mathbf{x}_n) + H(\mathbf{x}_n)(\mathbf{x} - \mathbf{x}_n) = 0$$

$$H(\mathbf{x}_n)(\mathbf{x} - \mathbf{x}_n) = -\nabla f(\mathbf{x}_n)$$

$$(\mathbf{x} - \mathbf{x}_n) = -H^{-1}(\mathbf{x}_n) \nabla f(\mathbf{x}_n)$$

**행렬로 나누는 것 = 역행렬 곱하기**이므로 자연스럽게 이 형태가 됩니다.

---

### 실제로는 어떻게 계산하나요?

#### Newton 방향 $\mathbf{d}$란?

**"현재 위치에서 얼마나 이동할지"** = 이동량입니다.

$$\mathbf{d} = \mathbf{x}_{n+1} - \mathbf{x}_n = -H^{-1}\nabla f$$

#### 역행렬 없이 $\mathbf{d}$ 구하기

$\mathbf{d} = -H^{-1}\nabla f$ 양변에 $H$를 곱하면:

$$H \mathbf{d} = -\nabla f$$

이건 **연립방정식**입니다! 역행렬 안 구하고 바로 $\mathbf{d}$를 구할 수 있습니다.

**예시** (2변수):
$$\begin{pmatrix} 2 & 3 \\ 3 & 4 \end{pmatrix} \begin{pmatrix} d_1 \\ d_2 \end{pmatrix} = \begin{pmatrix} -4 \\ -5 \end{pmatrix}$$

풀면: $2d_1 + 3d_2 = -4$, $3d_1 + 4d_2 = -5$ → $d_1, d_2$ 바로 계산!

#### 계산 순서

1. $H \mathbf{d} = -\nabla f$ 연립방정식 풀어서 $\mathbf{d}$ 구하기
2. $\mathbf{x}_{n+1} = \mathbf{x}_n + \mathbf{d}$ 로 업데이트

#### 왜 이게 더 효율적인가요?

```
역행렬 계산:     연립방정식 풀기:
  H⁻¹ 구하기       Hd = -∇f 풀기
  → O(n³)          → O(n³/3)

  3배 더 비쌈!     3배 빠름!
```

---

### 직관적 비유

```
2차원 예시:

등고선 지도에서 골짜기(최솟값) 찾기:

     ╭───────────╮
    ╱  ╭─────╮   ╲
   ╱  ╱ ╭───╮ ╲   ╲
  │  │  │ ● │  │   │   ← 골짜기 (최솟값)
   ╲  ╲ ╰───╯ ╱   ╱
    ╲  ╰─────╯   ╱
     ╰───────────╯

Gradient: "어느 방향이 가장 가파른가"
Hessian: "지형이 어떻게 휘어있나"

Newton 방법: 이 정보를 조합해서
            "골짜기까지 얼마나 가야 하나" 계산
```

---

## ✅ 최종 답안

### (1) 단변량 함수

$$x_{n+1} = x_n - \frac{f'(x_n)}{f''(x_n)}$$

- $f'(x_n)$: 현재 위치의 기울기
- $f''(x_n)$: 현재 위치의 곡률

### (2) 다변량 함수

$$\mathbf{x}_{n+1} = \mathbf{x}_n - H^{-1}(\mathbf{x}_n) \cdot \nabla f(\mathbf{x}_n)$$

- $\nabla f$: Gradient (기울기 벡터)
- $H = \nabla^2 f$: Hessian (곡률 행렬)

**실용적 구현**:
1. $H \cdot \mathbf{d} = -\nabla f$ 풀어서 방향 $\mathbf{d}$ 구하기
2. $\mathbf{x}_{n+1} = \mathbf{x}_n + \mathbf{d}$로 업데이트

---

**작성일**: 2025-12-03
**과목**: 금융수치해석기법 기말고사 2024
