# 문제 2: Explicit FDM (10점)

## 📚 강의 노트 참조
- **Lecture 03: Finite Difference Methods**
  - p.3: Introduction to FDM schemes
  - p.13: Explicit method formulation
  - p.17-18: Stability analysis and CFL condition

---

## 📋 원본 문제

> **문제 2 (10점)**
>
> Explicit FDM을 이용하여 옵션 가격을 산출하는 경우:
>
> **(1)** 오차를 줄이면서 계산 시간을 최소화하기 위한 방법들을 제시하시오. (5점)
>
> **(2)** 변동성 $\sigma$가 증가함에 따라 FDM이 발산하는 경우가 생길 수 있다. 발산하는 원인을 설명하고 발산을 해결하기 위한 방법을 제시하시오. (5점)

---

## 🎯 배경지식: Black-Scholes부터 이해하기

이 문제를 이해하려면 먼저 **왜 FDM을 쓰는지** 알아야 해요.

### 옵션이 뭔가요?

**옵션** = 미래에 주식을 특정 가격에 살 수 있는 **권리**

```
예시: 삼성전자 콜옵션

오늘 주가: 70,000원
행사가: 75,000원 (이 가격에 살 권리)
만기: 3개월 후

3개월 후 주가가...
  → 80,000원이면: 75,000원에 사서 80,000원에 팔기 = 5,000원 이익! 💰
  → 70,000원이면: 권리 포기 (75,000원에 살 이유 없음) = 0원
```

**질문**: 이 권리의 **오늘 가치**는 얼마일까요? 🤔

### Black-Scholes 방정식의 탄생

1973년, Black과 Scholes가 **옵션의 공정 가격**을 구하는 공식을 발견했습니다.

핵심 아이디어:
> "옵션과 주식을 적절히 섞으면 무위험 포트폴리오를 만들 수 있다"

이 아이디어를 수학으로 표현하면:

$$\frac{\partial V}{\partial t} + \frac{1}{2}\sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} + rS\frac{\partial V}{\partial S} - rV = 0$$

### 각 항의 직관적 의미

```
∂V/∂t        : 시간이 지나면 옵션 가치가 어떻게 변하나?
               (만기가 다가올수록 시간가치 감소)

½σ²S² ∂²V/∂S² : 주가가 출렁일 때 옵션 가치가 얼마나 휘나?
               (변동성이 클수록 옵션 가치 증가)

rS ∂V/∂S     : 주가가 오르면 콜옵션 가치도 오르는 정도
               (델타 효과)

-rV          : 무위험 이자율만큼 할인
               (미래 가치를 현재 가치로)
```

### 문제: 이 방정식을 어떻게 풀까요?

**간단한 경우** (유럽형 콜/풋):
- Black-Scholes **공식**으로 바로 계산 가능!

**복잡한 경우** (미국형, 배리어, 아시안 등):
- 공식이 없음 😢
- **수치적 방법**으로 풀어야 함 → **FDM 등장!**

---

## 🎯 FDM이 뭔가요?

### FDM = Finite Difference Method = 유한차분법

연속적인 미분방정식을 **격자점 위의 계산**으로 바꾸는 방법입니다.

### 왜 필요한가요?

컴퓨터는 **연속적인 곡선**을 직접 다룰 수 없어요.
대신 **점들의 집합**으로 근사합니다.

```
연속적인 옵션 가치         →        격자로 이산화

     V ↑                              V ↑
       │    ╭──────╮                    │  ●──●──●──●──●
       │   ╱        ╲                   │  │  │  │  │  │
       │  ╱          ╲                  │  ●──●──●──●──●
       │ ╱            ╲                 │  │  │  │  │  │
       │╱              ╲                │  ●──●──●──●──●
       └─────────────────→ S           └─────────────────→ S

    부드러운 곡면                    각 점에서 값을 계산!
```

### 격자 설정

```
S (주가) ↑
         │
  S_max ─┼─●──●──●──●──●──●  ← 주가 상한 (충분히 큰 값)
         │  │  │  │  │  │  │
         │  ●──●──●──●──●──●
         │  │  │  │  │  │  │
  Strike─┼─●──●──●──●──●──●  ← 행사가 (가장 중요!)
         │  │  │  │  │  │  │
         │  ●──●──●──●──●──●
         │  │  │  │  │  │  │
  S_min ─┼─●──●──●──●──●──●  ← 주가 하한 (0 또는 작은 값)
         │  │  │  │  │  │  │
         └──┴──┴──┴──┴──┴──┴──→ t (시간)
            T        ...    0
          만기              현재

시간을 거꾸로 계산! (만기 → 현재)
```

왜 거꾸로? 만기 때 옵션 가치는 알고 있으니까!
- 콜옵션 만기 가치: $\max(S - K, 0)$

---

## 🎯 Explicit 방법이란?

### "명시적"의 의미

**이미 아는 값**들로 **다음 값을 바로 계산**할 수 있다!

```
시간 흐름 (역방향: 만기 → 현재)

시점 k (만기 쪽, 이미 알고 있음):

        V_{i-1}^k     V_i^k     V_{i+1}^k
           ●───────────●───────────●
            ↘          ↓          ↙
             ↘         ↓         ↙
              ↘        ↓        ↙
               ────────●────────
                    V_i^{k+1}

시점 k+1 (현재 쪽, 구하려는 값):

→ 위의 세 값을 조합해서 바로 계산 가능!
```

### 계산 공식 (단순화)

$$V_i^{k+1} = a \cdot V_{i-1}^k + b \cdot V_i^k + c \cdot V_{i+1}^k$$

여기서 $a, b, c$는 $\sigma, r, \Delta t, \Delta S$로 결정되는 계수

### Explicit의 장점과 단점

| 장점 ✓ | 단점 ✗ |
|-------|-------|
| 계산이 빠르고 간단 | 조건 안 맞으면 **발산** |
| 병렬 처리 쉬움 | 작은 $\Delta t$ 필요 |
| 구현하기 쉬움 | 변동성 높으면 위험 |

---

## 💡 (1) 오차 줄이면서 계산 시간 최소화하기

### 딜레마 이해하기

일반적으로:
- 격자를 **촘촘하게** → 정확하지만 느림
- 격자를 **성기게** → 빠르지만 부정확

**똑똑하게** 계산하는 방법들을 알아봅시다!

---

### 방법 1: Richardson 외삽법

#### 아이디어

"두 번 계산해서 더 정확한 답을 얻자!"

#### 구체적인 방법

1. 격자 크기 $h$로 계산 → 결과 $V_1$
2. 격자 크기 $h/2$로 계산 → 결과 $V_2$
3. 두 결과를 **조합**:

$$V_{\text{정확}} \approx \frac{4 \times V_2 - V_1}{3}$$

#### 왜 이게 되나요?

오차가 $h^2$에 비례한다면:
- $V_1 = V_{\text{진짜}} + C \cdot h^2$
- $V_2 = V_{\text{진짜}} + C \cdot (h/2)^2 = V_{\text{진짜}} + C \cdot h^2/4$

두 식을 연립하면 $C$가 사라지고 더 정확한 값을 얻어요!

#### 직관적 비유

```
학생 A: "답이 100이야" (대충 계산)
학생 B: "답이 103이야" (조금 더 정밀 계산)

선생님: "둘의 패턴을 보니... 진짜 답은 104 정도겠네!"
        → 외삽(extrapolation)
```

---

### 방법 2: Crank-Nicolson 방법 사용

#### 아이디어

Explicit(빠름)과 Implicit(안정)의 **중간**을 취하자!

#### 정확도 비교

| 방법 | 시간 정확도 | 특징 |
|-----|-----------|------|
| Explicit | 1차 $(O(\Delta t))$ | 빠르지만 덜 정확 |
| Implicit | 1차 $(O(\Delta t))$ | 안정적이지만 덜 정확 |
| **Crank-Nicolson** | **2차** $(O(\Delta t^2))$ | 둘의 장점! |

#### 직관적 비유

```
Explicit: 현재 위치만 보고 뛰어가기 (빠름, 위험)
Implicit: 도착점을 보고 신중하게 가기 (안전, 복잡)
Crank-Nicolson: 현재와 도착점 둘 다 보고 가기 (균형!)
```

---

### 방법 3: 비균등 격자 사용

#### 아이디어

"중요한 곳에만 촘촘하게!"

#### 옵션 가격에서 중요한 곳은?

**행사가(Strike Price) 근처**입니다!

```
주가(S)
↑
│                              ● ● ●  ← 여긴 성기게 (옵션이 깊은 ITM)
│                        ●  ●
│                    ●  ●
│              ● ● ● ● ●           ← 행사가 근처: 촘촘하게! (가치 급변)
│          ●  ●
│      ●  ●
│  ● ● ●                           ← 여긴 성기게 (옵션이 깊은 OTM)
└────────────────────────────────→ 옵션가치(V)
```

왜냐하면:
- 행사가 근처: 옵션 가치가 급격히 변함 (정밀도 필요!)
- 멀리 떨어진 곳: 변화가 완만함 (대충 계산해도 OK)

---

## 💡 (2) 발산하는 원인과 해결책

### "발산"이 뭔가요?

계산 결과가 **미친 듯이 커지거나 진동**하는 현상입니다.

```
정상적인 계산:                    발산하는 계산:
시점 k=0: [10, 10, 10]           시점 k=0: [10, 10, 10]
시점 k=1: [10, 11, 10]           시점 k=1: [10, 12, 10]
시점 k=2: [10, 11, 10]           시점 k=2: [10, -5, 10]    ← 음수?!
시점 k=3: [10, 11, 10]           시점 k=3: [10, 100, 10]   ← 폭발!
    ↓                                ↓
  정상 수렴 ✓                    완전 발산 ✗
```

---

### 발산 원인: "안정성 조건" 위반

#### 안정성 조건이란?

Explicit 방법이 **안정적으로 작동하기 위한 조건**입니다.

이 조건을 **CFL 조건**이라고 부르는데:
- **CFL** = Courant-Friedrichs-Lewy (세 수학자 이름)
- 1928년에 발견된 수치해석의 기본 원리

#### Black-Scholes에서의 안정성 조건

$$\Delta t \leq \frac{(\Delta S)^2}{\sigma^2 S^2}$$

각 항목의 의미:

| 변수 | 의미 | 예시 |
|-----|------|-----|
| $\Delta t$ | 시간 간격 | 1일 = 1/252년 |
| $\Delta S$ | 주가 격자 간격 | 1,000원 |
| $\sigma$ | 변동성 (연율화) | 30% = 0.3 |
| $S$ | 주가 | 50,000원 |

#### 직관적 이해: 왜 이런 조건이 필요한가?

```
비유: 빠르게 움직이는 공을 카메라로 찍기

📷 상황 1: 공이 천천히 굴러감 (σ 작음)
   → 1초에 1장 찍어도 움직임 잘 보임
   → Δt 커도 OK

📷 상황 2: 공이 빠르게 튀어다님 (σ 큼)
   → 1초에 100장은 찍어야 궤적 보임
   → Δt 작아야 함

📷 상황 3: 느린 카메라로 빠른 공 찍기
   → 공이 순간이동하는 것처럼 보임
   → 발산! 💥
```

```
금융 버전:

🌊 변동성 = 주가의 "출렁임 정도"

변동성 낮을 때 (σ = 20%):
  주가가 천천히 움직임
  → 가끔 계산해도 OK (Δt 커도 됨)

변동성 높을 때 (σ = 80%):
  주가가 격렬하게 움직임
  → 자주 계산해야 함 (Δt 작아야 함)

만약 높은 변동성에서 Δt를 크게 잡으면?
  → 주가 변화를 못 따라감 → 발산!
```

#### 숫자 예시

```
조건: σ = 20%, S = 100, ΔS = 5

허용되는 Δt:
  Δt ≤ (5)² / (0.2² × 100²)
     = 25 / 400
     = 0.0625년 ≈ 16거래일

→ 16일에 한 번 계산해도 안정!


조건: σ = 80%, S = 100, ΔS = 5 (변동성 4배!)

허용되는 Δt:
  Δt ≤ (5)² / (0.8² × 100²)
     = 25 / 6400
     = 0.0039년 ≈ 1거래일

→ 매일 계산해야 안정!
→ 변동성 4배 → 허용 Δt는 16배 감소! (σ²에 반비례)
```

---

### 해결책 1: $\Delta t$ 줄이기

가장 직관적인 해결책!

$$\Delta t_{\text{새로운}} = \frac{\Delta t_{\text{기존}}}{2} \text{ 또는 더 작게}$$

**단점**: 계산 시간이 2배 이상 증가

---

### 해결책 2: Implicit 방법 사용

#### Implicit의 특징

**"무조건 안정" (Unconditionally Stable)**

어떤 $\Delta t$를 써도 발산하지 않아요!

#### 왜 그런가요?

Implicit 방법은 **미래 시점의 값들을 연립방정식으로 한꺼번에 구합니다.**

```
Explicit:                    Implicit:
알고 있는 값 → 바로 계산      연립방정식으로 동시에 풀기

  ●  ●  ●                      ●  ●  ●
   ↘ ↓ ↙                        ↑  ↑  ↑
     ?                         [? + ? + ? = 방정식]

빠르지만 불안정              느리지만 항상 안정!
```

#### 비유

```
Explicit: 눈 감고 뛰어가기
  → 빠르지만 넘어질 수 있음

Implicit: 발밑을 보며 걷기
  → 느리지만 절대 안 넘어짐
```

---

### 해결책 3: Crank-Nicolson 사용

Explicit과 Implicit의 **평균**을 사용!

- **무조건 안정** (Implicit의 장점)
- **높은 정확도** (2차 정확도)

실무에서 가장 많이 쓰이는 방법입니다.

---

## ✅ 최종 답안

### (1) 오차 줄이면서 계산 시간 최소화

| 방법 | 핵심 아이디어 |
|-----|-------------|
| Richardson 외삽법 | 두 번 계산 → 조합으로 정확도 향상 |
| Crank-Nicolson | Explicit+Implicit 평균 → 2차 정확도 |
| 비균등 격자 | 중요한 곳(행사가 근처)만 촘촘하게 |

### (2) 발산 원인과 해결

| 항목 | 내용 |
|-----|------|
| **원인** | 변동성 증가 → 안정성 조건(CFL) 위반 |
| **조건** | $\Delta t \leq (\Delta S)^2 / (\sigma^2 S^2)$ |
| **해결 1** | $\Delta t$ 줄이기 |
| **해결 2** | Implicit 방법 사용 (무조건 안정) |
| **해결 3** | Crank-Nicolson 사용 (무조건 안정 + 높은 정확도) |

---

**작성일**: 2025-12-03
**과목**: 금융수치해석기법 기말고사 2024
