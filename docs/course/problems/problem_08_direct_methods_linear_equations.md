# 문제 8: 직접법으로 선형방정식 풀기 (15점)

## 📚 강의 노트 참조
- **Lecture 02: Linear System of Equations**
  - p.2-5: Introduction to linear systems
  - p.6-10: LU decomposition
  - p.11-14: Cholesky decomposition
  - p.26: Sparse matrices (tridiagonal systems)
  - p.34: Summary of direct methods

---

## 📋 원본 문제

> **문제 8 (15점)**
>
> 선형 방정식 $A\mathbf{x} = \mathbf{b}$를 역행렬 $A^{-1}$을 직접 계산하지 않고 풀 수 있는 방법들을 제시하고 각 방법의 특징을 설명하시오.

---

## 🎯 문제가 뭘 묻는 건가요?

연립방정식을 풀 때, **역행렬을 쓰지 않는 방법**들을 물어보는 문제입니다.

---

## 💡 먼저: 왜 역행렬을 피하나요?

### 역행렬 사용하는 방법

$$A\mathbf{x} = \mathbf{b} \quad \Rightarrow \quad \mathbf{x} = A^{-1}\mathbf{b}$$

단순해 보이지만, **실제로는 나쁜 방법**입니다!

### 역행렬의 문제점

| 문제 | 설명 |
|-----|------|
| **느림** 🐢 | $A^{-1}$ 계산에 $O(n^3)$ 연산 필요 |
| **부정확** ❌ | 계산 오차가 누적됨 |
| **비효율** 💾 | 원래 희소 행렬이어도 역행렬은 꽉 찬 행렬 |

### 비유로 이해하기

```
"서울에서 부산 가기"

역행렬 방법:
  1. 먼저 전국 모든 도시 간 거리표 완성 (역행렬 계산)
  2. 거리표에서 서울→부산 찾기
  → 너무 오래 걸림!

직접법:
  서울 → 대전 → 대구 → 부산 (필요한 경로만 계산)
  → 훨씬 빠름!
```

---

## 💡 핵심 아이디어: "분해 후 대입"

역행렬 대신, 행렬을 **쉬운 형태로 분해**합니다.

```
어려운 문제:  Ax = b
                ↓ 분해
쉬운 문제들: L(Ux) = b
             └→ y = Ux라 하면
                Ly = b (쉬움!)
                Ux = y (쉬움!)
```

**삼각행렬**은 아래/위에서 차례로 풀면 되니까 매우 쉽습니다!

---

## 💡 방법 1: LU 분해 (가장 기본!)

### LU가 뭔가요?

행렬 $A$를 두 삼각행렬의 곱으로 분해:

$$A = LU$$

- **L** = Lower triangular (하삼각행렬, 대각선 아래만)
- **U** = Upper triangular (상삼각행렬, 대각선 위만)

```
┌─────────┐   ┌─────────┐   ┌─────────┐
│ ■ ■ ■ ■ │   │ ■ 0 0 0 │   │ ■ ■ ■ ■ │
│ ■ ■ ■ ■ │ = │ ■ ■ 0 0 │ × │ 0 ■ ■ ■ │
│ ■ ■ ■ ■ │   │ ■ ■ ■ 0 │   │ 0 0 ■ ■ │
│ ■ ■ ■ ■ │   │ ■ ■ ■ ■ │   │ 0 0 0 ■ │
└─────────┘   └─────────┘   └─────────┘
     A              L              U
   (복잡)        (하삼각)       (상삼각)
```

### 어떻게 푸나요?

**Step 1**: $A = LU$ 분해 (한 번만)

**Step 2**: $L\mathbf{y} = \mathbf{b}$ 풀기 (전진대입)

위에서 아래로 차례로:
```
y₁ = b₁ / L₁₁
y₂ = (b₂ - L₂₁y₁) / L₂₂
y₃ = (b₃ - L₃₁y₁ - L₃₂y₂) / L₃₃
...
```

**Step 3**: $U\mathbf{x} = \mathbf{y}$ 풀기 (후진대입)

아래에서 위로 차례로:
```
xₙ = yₙ / Uₙₙ
x_{n-1} = (y_{n-1} - U_{n-1,n}xₙ) / U_{n-1,n-1}
...
```

### 특징

| 항목 | 내용 |
|-----|------|
| 언제 사용? | **일반적인 행렬**에 기본 선택 |
| 계산량 | $O(n^3/3)$ — 역행렬의 1/3 |
| 장점 | 같은 $A$로 여러 $\mathbf{b}$ 풀 때 효율적 |

---

## 💡 방법 2: Cholesky 분해 (대칭 양정치용)

### 언제 쓰나요?

행렬 $A$가 **대칭**이고 **양정치**일 때:
- 대칭: $A = A^T$ (뒤집어도 같음)
- 양정치: 모든 고유값 > 0 (기하학적으로 "위로 볼록한 그릇")

**금융 예시**: 공분산 행렬, 상관계수 행렬

### 분해 형태

$$A = LL^T$$

L 하나로 충분! (L과 그 전치만 사용)

```
┌─────────┐   ┌─────────┐   ┌─────────┐
│ ■ ■ ■ ■ │   │ ■ 0 0 0 │   │ ■ ■ ■ ■ │
│ ■ ■ ■ ■ │ = │ ■ ■ 0 0 │ × │ 0 ■ ■ ■ │
│ ■ ■ ■ ■ │   │ ■ ■ ■ 0 │   │ 0 0 ■ ■ │
│ ■ ■ ■ ■ │   │ ■ ■ ■ ■ │   │ 0 0 0 ■ │
└─────────┘   └─────────┘   └─────────┘
     A              L            L^T
```

### 특징

| 항목 | 내용 |
|-----|------|
| 언제 사용? | **대칭 양정치 행렬** (공분산 등) |
| 계산량 | $O(n^3/6)$ — **LU의 절반!** |
| 장점 | 메모리 절약 (L만 저장), 항상 안정적 |

---

## 💡 방법 3: Thomas 알고리즘 (삼중대각 행렬용)

### 삼중대각 행렬이 뭔가요?

대각선과 바로 위/아래만 값이 있는 행렬:

```
┌─────────────────┐
│ ■ ■ 0 0 0 0 0 0 │
│ ■ ■ ■ 0 0 0 0 0 │
│ 0 ■ ■ ■ 0 0 0 0 │
│ 0 0 ■ ■ ■ 0 0 0 │
│ 0 0 0 ■ ■ ■ 0 0 │
│ 0 0 0 0 ■ ■ ■ 0 │
│ 0 0 0 0 0 ■ ■ ■ │
│ 0 0 0 0 0 0 ■ ■ │
└─────────────────┘

대부분이 0!
```

**언제 나오나요?** 유한차분법(FDM)에서 Implicit 방법을 쓰면 이런 형태가 됩니다!

### 알고리즘 아이디어

전체 행렬을 저장할 필요 없이, **세 개의 대각선만** 저장하고 계산:

```
저장할 것:
  a = [a₂, a₃, ..., aₙ]      (하대각)
  b = [b₁, b₂, ..., bₙ]      (주대각)
  c = [c₁, c₂, ..., cₙ₋₁]    (상대각)
  d = [d₁, d₂, ..., dₙ]      (우변)
```

### 특징

| 항목 | 내용 |
|-----|------|
| 언제 사용? | **FDM**에서 Implicit 방법! |
| 계산량 | $O(n)$ — **엄청 빠름!** |
| 메모리 | $O(n)$ — n×n 대신 3n만 저장 |

### 이게 왜 중요한가요?

```
100×100 격자로 옵션 가격 계산:

일반 방법 (LU):
  100×100 = 10,000개 값 저장
  연산: 100³/3 ≈ 333,333회

Thomas 알고리즘:
  100×3 = 300개 값 저장
  연산: 100×5 ≈ 500회

→ 600배 이상 빠름!
```

---

## 💡 방법 4: QR 분해 (안정성 필요할 때)

### 분해 형태

$$A = QR$$

- **Q** = 직교행렬 ($Q^T Q = I$, 길이와 각도 보존)
- **R** = 상삼각행렬

### 어떻게 푸나요?

$$A\mathbf{x} = \mathbf{b}$$
$$QR\mathbf{x} = \mathbf{b}$$
$$R\mathbf{x} = Q^T\mathbf{b}$$

$Q^T$는 그냥 $Q$를 뒤집으면 되고, $R$은 상삼각이라 후진대입으로 품!

### 특징

| 항목 | 내용 |
|-----|------|
| 언제 사용? | **수치적 안정성**이 중요할 때 |
| 계산량 | $O(2n^3/3)$ — LU보다 2배 비쌈 |
| 장점 | 가장 안정적, 비정방 행렬도 OK |

---

## 💡 방법 5: SVD 분해 (만능 해결사)

### SVD = Singular Value Decomposition = 특이값 분해

$$A = U\Sigma V^T$$

- **U, V** = 직교행렬
- **Σ** = 대각행렬 (특이값들)

### 언제 쓰나요?

- 행렬이 **정방이 아닐 때** (행≠열)
- 행렬이 **특이**(singular)하거나 거의 특이할 때
- **최소제곱 해**가 필요할 때

### 특징

| 항목 | 내용 |
|-----|------|
| 언제 사용? | **어떤 행렬이든** 가능! |
| 계산량 | 가장 비쌈 |
| 장점 | 랭크 부족도 처리, 조건수 파악 가능 |

---

## 💡 어떤 방법을 선택해야 하나요?

### 선택 가이드 (플로우차트)

```
시작: A가 어떤 형태?
      │
      ├─ 삼중대각? ──────→ Thomas 알고리즘 (가장 빠름!)
      │
      ├─ 대칭 양정치? ───→ Cholesky (LU의 2배 빠름!)
      │
      ├─ 일반 정방 행렬? ─→ LU (기본 선택)
      │
      ├─ 안정성 중요? ───→ QR (느리지만 안정)
      │
      └─ 특이/비정방? ───→ SVD (만능)
```

### 요약 표

| 방법 | A의 형태 | 속도 | 금융 응용 |
|-----|---------|-----|----------|
| **Thomas** | 삼중대각 | ⭐⭐⭐⭐⭐ $O(n)$ | FDM |
| **Cholesky** | 대칭 양정치 | ⭐⭐⭐⭐ $O(n^3/6)$ | 공분산 행렬 |
| **LU** | 일반 | ⭐⭐⭐ $O(n^3/3)$ | 기본 선택 |
| **QR** | 일반/비정방 | ⭐⭐ $O(2n^3/3)$ | 최소제곱 |
| **SVD** | 모든 행렬 | ⭐ (가장 느림) | PCA, 회귀 |

---

## 💡 실제 금융에서의 사용

### 옵션 가격 계산 (FDM)

```
Implicit FDM → 삼중대각 행렬 → Thomas 알고리즘!

매 시간 스텝마다 100개 격자점 계산:
  일반 방법: 100³ = 1,000,000 연산
  Thomas: 100×5 = 500 연산

→ 2000배 빠름!
```

### 포트폴리오 최적화

```
공분산 행렬 Σ 계산 → 대칭 양정치 → Cholesky!

100개 종목:
  일반 LU: 100³/3 ≈ 333,333 연산
  Cholesky: 100³/6 ≈ 166,667 연산

→ 2배 빠름!
```

---

## ✅ 최종 답안

역행렬을 직접 계산하지 않고 $A\mathbf{x} = \mathbf{b}$를 푸는 방법들:

### 1. LU 분해
- $A = LU$로 분해 후 전진/후진대입
- 일반적인 행렬에 **기본 선택**

### 2. Cholesky 분해
- $A = LL^T$로 분해
- **대칭 양정치 행렬**에서 LU의 2배 빠름

### 3. Thomas 알고리즘
- 삼중대각 행렬 전용
- $O(n)$으로 **FDM에서 필수!**

### 4. QR 분해
- $A = QR$로 분해
- **가장 안정적**, 최소제곱 문제에 적합

### 5. SVD 분해
- $A = U\Sigma V^T$로 분해
- **어떤 행렬이든** 처리 가능

---

**작성일**: 2025-12-03
**과목**: 금융수치해석기법 기말고사 2024
